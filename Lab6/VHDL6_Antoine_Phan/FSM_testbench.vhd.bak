library IEEE;
use IEEE.std_logic_1164.all;
use IEEE.numeric_std.all;

entity FSM_Testbench is
end entity;

architecture tb of FSM_Testbench is
    component Antoine_Phan_FSM
        port(
            seq : in std_logic;
            enable, reset, clk: in std_logic;
            out_1, out_2: out std_logic
        );
    end component;

    signal seq, enable, reset, clk: std_logic;
    signal out_1, out_2: std_logic := 0;
    constant clock_period: time := 20 ns;

    type seq_sample is array (0 to 20) of std_logic;
    signal seq_samples: seq_sample := (
        0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1
    );
    signal i: integer := 0;

begin
    -- Clock generation
    clock_generation : process
    begin
        clk <= '1';
        wait for clock_period/2;
        clk <= '0';
        wait for clock_period/2;
    end process;

    -- FSM instantiation
    FSM: Antoine_Phan_FSM port map(
        seq => seq,
        enable => enable,
        reset => reset,
        clk => clk,
        out_1 => out_1,
        out_2 => out_2
    );

    -- Simulation process
    simulation : process
    begin
        reset <= '1';
        enable <= '1';
        if rising_edge(clk) then
            if i = 21 then
                i <= 0;
            end if;
            seq <= seq_samples(i);
            i <= i + 1;
        end if;
    end process;
end architecture tb;
